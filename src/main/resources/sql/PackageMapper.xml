<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.happytravel.btoc.dao.PackageDao">

    <!-- 전체 패키지 목록 조회 -->
    <select id="getCountByCountry" resultType="kr.happytravel.btoc.dto.CntPerCountryList"
            parameterType="hashmap">
        SELECT
        c.COUNTRY_CODE,
        c.KOREAN_NAME,
        c.COUNTRY_IMAGE,
        COUNT(p.PACKAGE_CODE) AS PACKAGE_COUNT
        FROM
        TB_COUNTRY_INFO c
        JOIN
        TB_PACKAGE_INFO p ON c.COUNTRY_CODE = p.COUNTRY_CODE
        WHERE
        c.COUNTRY_IMAGE IS NOT NULL
        AND p.ASSIGN_CODE = '2000'
        AND p.IS_USED = 'Y'
        GROUP BY
        c.COUNTRY_CODE, c.KOREAN_NAME, c.COUNTRY_IMAGE
        ORDER BY
        c.COUNTRY_CODE
    </select>

    <!-- 전체 패키지 목록 조회 -->
    <select id="getTop5Package" resultType="kr.happytravel.btoc.dto.Top5Package"
            parameterType="hashmap">
        SELECT
        p.PACKAGE_CODE,
        p.PACKAGE_NAME,
        c.COUNTRY_IMAGE,
        p.PACKAGE_INFO,
        p.SALE_AMOUNT,
        p.SALE_PRICE,
        DATEDIFF(p.END_DATE, p.START_DATE) AS days,
        c.KOREAN_NAME as countryName,
        h.REGION
        FROM
        TB_PACKAGE_INFO p
        JOIN
        TB_COUNTRY_INFO c ON p.COUNTRY_CODE = c.COUNTRY_CODE
        JOIN
        TB_HOTEL_INFO h ON p.HOTEL_CODE = h.HOTEL_CODE
        WHERE
        c.COUNTRY_IMAGE IS NOT NULL
        AND p.ASSIGN_CODE = '2000'
        AND p.IS_USED = 'Y'
        ORDER BY
        p.SALE_AMOUNT DESC
        LIMIT 5
    </select>


    <!-- 전체 목록 카운트 -->

    <!-- 단건 조회 -->


    <!-- INSERT 쿼리 -->


    <!-- UPDATE 쿼리 -->




</mapper>